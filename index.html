<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        /*
        1. Написать функцию, преобразующую число в объект. Передавая на вход число от 0 до 999, надо 
        получить на выходе объект, в котором в соответствующих свойствах описаны единицы, десятки и сотни. 
        Например, для числа 245 надо получить следующий объект: {‘единицы’: 5, ‘десятки’: 4, ‘сотни’: 2}. 
        Если число превышает 999, необходимо выдать соответствующее сообщение с помощью console.log и 
        вернуть пустой объект.
        */

        let userNumber = prompt('Введите число от 0 до 999: ');
        function numberToObject(num) {
            let userObject = {};
            if (+num > 999) {
                console.log(`Необходимо ввести число в диапазоне 0 ... 999 ${userObject}`)
            }
            else {
                let str = userNumber.split('').reverse();
                userObject = {
                    'units': +str[0],
                    'tens': str[1] == undefined ? 0 : +str[1],
                    'hundreds': str[2] == undefined ? 0 : +str[2]
                }
                console.log(userObject);
            }
        }

        numberToObject(userNumber);

        /*
        2. Продолжить работу с интернет-магазином:
        В прошлом домашнем задании вы реализовали корзину на базе массивов. Какими объектами можно заменить их элементы?
        Реализуйте такие объекты.
        Перенести функционал подсчета корзины на объектно-ориентированную базу.
        */
        let userBasket = {
            basket: {},
            addToBasket: function (item) {
                this.basket[item.name] = { price: item.price, amount: item.amount }
            },
            addItemAmount: function (itemName) {
                this.basket[itemName]['amount'] += 1; // увеличиваем число едениц товара
            },
            countBasketPrice: function () {
                let basketPrice = 0;
                for (item in this.basket) {
                    basketPrice += (this.basket[item]['price'] * this.basket[item]['amount'])
                }
                return basketPrice;
            }

        }

        function Product(name, price, amount) {
            this.name = name;
            this.amount = amount;
            this.price = price;
            return { name: this.name, price: this.price, amount: this.amount }
        }

        let item1 = new Product('first item', 1200, 1)
        let item2 = new Product('second item', 1500, 1)
        let item3 = new Product('third item', 3000, 1)

        userBasket.addToBasket(item1);
        userBasket.addToBasket(item2);
        userBasket.addToBasket(item3);

        // тестируем изначальное состояние корзины
        alert(`Суммарная стоимость товаров в корзине: ${userBasket.countBasketPrice()} рублей`)

        //тестируем состояние корзины после увеличения количества едениц продукта
        userBasket.addItemAmount('first item') // увеличиваем число едениц первого товара
        userBasket.addItemAmount('second item') // увеличиваем число едениц второго товара
        alert(`Суммарная стоимость товаров в корзине: ${userBasket.countBasketPrice()} рублей`)



        /*
        3. * Подумать над глобальными сущностями. К примеру, сущность «Продукт» в интернет-магазине
        актуальна не только для корзины, но и для каталога. Стремиться нужно к тому, чтобы объект
        «Продукт» имел единую структуру для различных модулей сайта, но в разных местах давал возможность
        вызывать разные методы.
        */

        let product = {
            promo: {
                sale5: 0.05,
                sale10: 0.1,
                sale15: 0.15,
                sale20: 0.20
            },
            code: 'MP002XM0RGXF',
            name: 'some boots',
            color: 'black',
            size: 41,
            amount: 1,
            priceForItem: 10000,
            getPrice: function () {
                return this.priceForItem; // возвращает текущую цену товара
            },
            addAmount: function (newAmount) {
                this.amount = newAmount; // для увеличения количества товаров одной позиции
                if (this.amount >= 3) this.priceForItem *= 0.9; // если покупается больше двух товаров, изменяем цену
            },
            setDefaultAmount: function () {
                this.amount = 1; // устанавливает дефолтное количество товаро
            },
            setDefaultPrice: function () {
                this.priceForItem = 10000;
            },
            getPromo: function (promocode) {
                this.priceForItem -= this.priceForItem * this.promo[promocode];
            }

        }
        console.log('Initial price:')
        console.log(product.getPrice())
        product.addAmount(3);
        console.log('Price for amount if number of items >= 3:');
        console.log(product.getPrice())
        product.setDefaultAmount();
        product.setDefaultPrice();
        product.getPromo('sale15');
        console.log('Price for one item afrer using promo code:');
        console.log(product.getPrice());

    </script>
</body>

</html>
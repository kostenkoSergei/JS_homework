<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="basket">
    </div>
    <div id="catalog">

    </div>

    <script>
        /*
        1. Создать функцию, генерирующую шахматную доску. Можно использовать любые html-теги.
        Доска должна быть верно разлинована на черные и белые ячейки. Строки должны нумероваться
        числами от 1 до 8, столбцы — латинскими буквами A, B, C, D, E, F, G, H.
        */

        let letters = ['', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']
        let numbers = [8, 7, 6, 5, 4, 3, 2, 1]
        function createCell(color) {
            let blackCell = document.createElement('div');
            let whiteCell = document.createElement('div');
            if (color == 'black') {
                blackCell.className = 'black';
                return blackCell;
            }
            else if (color == 'white') {
                whiteCell.className = 'white';
                return whiteCell;
            }

        }

        function createSign() {
            let signCell = document.createElement('div');
            signCell.className = 'sign';
            return signCell;
        }

        function createRow(num) {
            let row = document.createElement('div');
            row.className = 'row';
            document.body.appendChild(row);
            let number = createSign();
            number.innerHTML = num;
            row.appendChild(number);
            return row
        }

        function createCellRow(num, flag) {
            row = createRow(num);
            if (flag) {
                for (i = 0; i < 4; i++) {
                    row.appendChild(createCell('white'));
                    row.appendChild(createCell('black'));
                }
            }
            else {
                for (i = 0; i < 4; i++) {
                    row.appendChild(createCell('black'));
                    row.appendChild(createCell('white'));
                }
            }
        }


        function createLetterRow(k) {
            for (k = 0; k <= 8; k++) {
                let el = createSign();
                document.body.appendChild(el);
                el.innerHTML = letters[k];
            }
        }

        function drawСhessboard() {
            k = 0;
            v = 1;
            createLetterRow(k, v)
            for (j = 0; j < 4; j++) {
                createCellRow(numbers[k], 1);
                createCellRow(numbers[v], 0);
                k += 2;
                v += 2;
            }
            createLetterRow(k)

        }

        drawСhessboard();

        /*
        2. Сделать генерацию корзины динамической: верстка корзины не должна находиться в HTML-структуре. 
        Там должен быть только div, в который будет вставляться корзина, сгенерированная на базе JS:
        Пустая корзина должна выводить строку «Корзина пуста»;
        Наполненная должна выводить «В корзине: n товаров на сумму m рублей».
        */
        let isEmpty = +prompt('Введите 0, чтобы отобразить пустую корзину, 1 - для отображения полной: ')

        let userBasket = {
            basket: {},
            addToBasket: function (item) {
                this.basket[item.name] = { price: item.price, amount: item.amount }
            },
            addItemAmount: function (itemName) {
                this.basket[itemName]['amount'] += 1; // увеличиваем число едениц товара
            },
            countBasketPrice: function () {
                let basketPrice = 0;
                let basketAmount = 0;
                for (item in this.basket) {
                    basketPrice += (this.basket[item]['price'] * this.basket[item]['amount']);
                    basketAmount += this.basket[item]['amount'];
                }
                return [basketPrice, basketAmount];
            }

        }

        function Product(name, code, size, color, price, amount) {
            this.name = name;
            this.code = code;
            this.size = size;
            this.color = color;
            this.amount = amount;
            this.price = price;
            return { name: this.name, code: this.code, size: this.size, color: this.color, price: this.price, amount: this.amount }
        }

        let item1 = new Product('first item', 'MP002XM0RGXF', 41, 'black', 1200, 1)
        let item2 = new Product('second item', 'LP002XD0RGXF', 48, 'green', 1500, 1)
        let item3 = new Product('third item', 'VP002FM0RGF', 50, 'white', 3000, 1)

        userBasket.addToBasket(item1);
        userBasket.addToBasket(item2);
        userBasket.addToBasket(item3);
        userBasket.addItemAmount('first item') // увеличиваем число едениц первого товара
        userBasket.addItemAmount('second item') // увеличиваем число едениц второго товара

        function createBasketView() {
            let basketView = document.getElementsByClassName('basket');
            let basketImg = document.createElement('img');
            basketImg.src = "img/basket.png";
            basketImg.style.maxWidth = '50px';
            let basketText = document.createElement('p');
            basketText.className = 'basketText';
            basketView[0].appendChild(basketImg);
            basketView[0].appendChild(basketText);
            if (isEmpty == 0) {
                basketText.innerText = ' Корзина пуста';
            }
            else if (isEmpty == 1) {
                res = userBasket.countBasketPrice();
                basketText.innerText = ` В корзине: ${res[1]} товаров на сумму ${res[0]} рублей`
            }
            else alert('Введите либо 0, либо 1')
        }

        createBasketView();

        /*
        * Сделать так, чтобы товары в каталоге выводились при помощи JS: Создать массив товаров (сущность Product);
        При загрузке страницы на базе данного массива генерировать вывод из него.
        HTML-код должен содержать только div id=”catalog” без вложенного кода. Весь вид каталога генерируется JS.
         */

        let productsCatalog = [item1, item2, item3];

        function showCatalog(products) {
            let catalogView = document.querySelector('#catalog');
            let catalog = document.createElement('p')
            catalog.textContent = 'Каталог:';
            catalog.classList.add('catalogText');
            catalogView.appendChild(catalog);
            let productList = document.createElement('ul');
            productList.classList.add('list-group')
            for (i = 0; i < products.length; i++) {
                let item = document.createElement('li');
                item.classList.add('list-group-item')
                product = products[i]
                item.textContent = `name: ${product.name}; size: ${product.size};  color: ${product.color}; code: ${product.code}; price: ${product.price};`
                productList.appendChild(item);
            }
            catalogView.appendChild(productList);
        }
        showCatalog(productsCatalog);

    </script>
</body>

</html>